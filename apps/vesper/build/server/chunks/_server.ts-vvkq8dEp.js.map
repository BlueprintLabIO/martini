{"version":3,"file":"_server.ts-vvkq8dEp.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/play/_shareCode_/assets/_server.ts.js"],"sourcesContent":["import { error, json } from \"@sveltejs/kit\";\nimport { g as getProjectByShareCode } from \"../../../../../../chunks/shareCode.js\";\nimport { d as db, p as projects, a as assets } from \"../../../../../../chunks/index3.js\";\nimport { eq } from \"drizzle-orm\";\nimport { P as PUBLIC_SUPABASE_URL } from \"../../../../../../chunks/public.js\";\nconst GET = async ({ params }) => {\n  const { shareCode } = params;\n  let project;\n  const isUUID = shareCode.length > 6 && shareCode.includes(\"-\");\n  if (isUUID) {\n    const result = await db.select().from(projects).where(eq(projects.id, shareCode)).limit(1);\n    if (result.length === 0) {\n      throw error(404, \"Game not found\");\n    }\n    project = result[0];\n  } else {\n    project = await getProjectByShareCode(shareCode.toUpperCase());\n    if (!project) {\n      throw error(404, \"Game not found\");\n    }\n    if (project.state !== \"published\" || !project.shareCode) {\n      throw error(404, \"Game not available\");\n    }\n  }\n  const projectAssets = await db.select().from(assets).where(eq(assets.projectId, project.id));\n  return json({\n    assets: projectAssets.map((asset) => ({\n      id: asset.id,\n      filename: asset.filename,\n      fileType: asset.fileType,\n      url: `${PUBLIC_SUPABASE_URL}/storage/v1/object/public/game-assets/${asset.storagePath}`\n    }))\n  });\n};\nexport {\n  GET\n};\n"],"names":[],"mappings":";;;;;;;;;;AAKK,MAAC,GAAG,GAAG,OAAO,EAAE,MAAM,EAAE,KAAK;AAClC,EAAE,MAAM,EAAE,SAAS,EAAE,GAAG,MAAM;AAC9B,EAAE,IAAI,OAAO;AACb,EAAE,MAAM,MAAM,GAAG,SAAS,CAAC,MAAM,GAAG,CAAC,IAAI,SAAS,CAAC,QAAQ,CAAC,GAAG,CAAC;AAChE,EAAE,IAAI,MAAM,EAAE;AACd,IAAI,MAAM,MAAM,GAAG,MAAM,EAAE,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC,EAAE,CAAC,QAAQ,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;AAC9F,IAAI,IAAI,MAAM,CAAC,MAAM,KAAK,CAAC,EAAE;AAC7B,MAAM,MAAM,KAAK,CAAC,GAAG,EAAE,gBAAgB,CAAC;AACxC,IAAI;AACJ,IAAI,OAAO,GAAG,MAAM,CAAC,CAAC,CAAC;AACvB,EAAE,CAAC,MAAM;AACT,IAAI,OAAO,GAAG,MAAM,qBAAqB,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC;AAClE,IAAI,IAAI,CAAC,OAAO,EAAE;AAClB,MAAM,MAAM,KAAK,CAAC,GAAG,EAAE,gBAAgB,CAAC;AACxC,IAAI;AACJ,IAAI,IAAI,OAAO,CAAC,KAAK,KAAK,WAAW,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE;AAC7D,MAAM,MAAM,KAAK,CAAC,GAAG,EAAE,oBAAoB,CAAC;AAC5C,IAAI;AACJ,EAAE;AACF,EAAE,MAAM,aAAa,GAAG,MAAM,EAAE,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,EAAE,CAAC,MAAM,CAAC,SAAS,EAAE,OAAO,CAAC,EAAE,CAAC,CAAC;AAC9F,EAAE,OAAO,IAAI,CAAC;AACd,IAAI,MAAM,EAAE,aAAa,CAAC,GAAG,CAAC,CAAC,KAAK,MAAM;AAC1C,MAAM,EAAE,EAAE,KAAK,CAAC,EAAE;AAClB,MAAM,QAAQ,EAAE,KAAK,CAAC,QAAQ;AAC9B,MAAM,QAAQ,EAAE,KAAK,CAAC,QAAQ;AAC9B,MAAM,GAAG,EAAE,CAAC,EAAE,mBAAmB,CAAC,sCAAsC,EAAE,KAAK,CAAC,WAAW,CAAC;AAC5F,KAAK,CAAC;AACN,GAAG,CAAC;AACJ;;;;"}